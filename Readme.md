[TOC]

# 表格目录

* `excel` :  游戏配置数据 `excel` 文件。
* `enum`:  游戏用到的枚举文件。
* `client`:  客户端数据导出目录。
*  `server`: 服务器数据导出目录。
* `csharptable`:  客户端数据表的 `cs` 代码文件。
* `csharpenumcode`: 客户端枚举的 `cs` 代码文件

# 数据配置(Main)

## 约定

1. 表名为下划线分割，全部小写。如：`static_activity.xlsx`。
2. 每个表分别有两个 `sheet`, 分别是 `Main` 和 `Setting`。
3. `Main` 为数据表、`Setting` 为表格约束配置表。
4. `Main` 的开头四行分别为：导出范围（客户端或服务器、全部）、字段类型、字段注释、字段名。
5. 支持的字段类型
   * `Byte`、`Int8`
   * `Double`
   * `Float`
   * `Short` 、`Int16`
   * `Int`  、`Int32`、`Lang`、`Int64`
   * `Long`
   * `String`
   * `Time (YYYY/mm/dd HH:ii)`
   * `IntArray` :  配置格式  “1|2|3|4 ”
   * `IntIntDictionary`: 配置格式   “1,2|3,4|5,6”
   * `StringArray`: 配置格式  “a|b|3|4”
6. 表可以不定义主键，如果表需要定义主键，那么主键字段的类型必须为 `Int32`， 并且字段注释为 “主键”。
7. 如果字段名为 “*”  、导出范围不填， 那么导出表的时候，该列将被忽略。

| All   | Client        | All      | Server              |          | Client          |
| ----- | ------------- | -------- | ------------------- | -------- | --------------- |
| int32 | int16         | int16    | time                | lang     | string          |
| 主键  | 显示顺序      | 活动类型 | 活动结算开始时间    | 活动名   | 活动banner      |
| id    | display_order | type     | start_time_absolute | *        | image           |
| 1     | 2             | 2        | 2018/3/19 0:00      | 首充     | image_banner_l1 |
| 17    | 11            | 2        | 2018/7/27 0:00      | 激活码   | 22              |
| 27    | 9             | 2        | 2018/3/19 0:00      | 每日特惠 | image_banner3   |

# 枚举配置

## 约定

1. 名字以 “枚举#” 或 “enum#” 开头的 `sheet` 默认为一个枚举类型，如： "enum#战斗枚举"。

2. 枚举文件有三个列，第一行开头的三个列默认分别是枚举名、枚举值、枚举注释。

3. 枚举名如果要指定继承类型，可用 “#”  补充在后面，如：`ActivityType#byte`。

4. 枚举名为导出的 `cs` 枚举类名，驼峰写法。

   | ActivityType#byte     | 值   | 注释             |
   | ---------------- | ---- | ---------------- |
   | GreenHandler     | 1    | 新手活动     |
   | Plan             | 2    | 计划       |

# 表格约束(Setting)

## 约定

1. 表格约定定义在每个数据表的 `Setting` 表格里面，开头行为标题行，列分别是字段名、限制类型、参数。

   

## 限制类型

### 枚举（enum）

参数为枚举配置定义的枚举名。

| 字段名 | 约束类型 | 参数         |
| ------ | -------- | ------------ |
| type   | enum     | ActivityType |

或

| 字段名 | 约束类型 | 参数         |
| ------ | -------- | ------------ |
| type   | 枚举     | ActivityType |

### 关联

| 字段名  | 约束类型    | 参数                 |
| ------- | ----------- | -------------------- |
| card_id | association | 关联表名\|关联字段名 |

或

| 字段名  | 约束类型 | 参数                 |
| ------- | -------- | -------------------- |
| card_id | 关联     | 关联表名\|关联字段名 |

### 唯一性

| 字段名 | 约束类型 | 参数 |
| ------ | -------- | ---- |
| id     | 唯一值   |      |

或

| 字段名 | 约束类型 | 参数 |
| ------ | -------- | ---- |
| id     | unique   |      |

# CS表文件配置

1. `StaticDataLoader` 的变量  `_byteDataPath` ，指定二进制文件的加载路径。
2. 将工程目录下的 `excel/template` 目录拷贝到程序执行的同一级目录。
